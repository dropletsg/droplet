<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<h3>Active Cases</h3>
<div class="container d-flex mt-4 p-0  align-items-center">
  <div>
    <h6 class="a">Filter By:</h6>
  </div>
  <div id="category-btn">
    <% unless @category %>
      <a class="btn btn-primary btn-round" href='active_cases'>Show all</a>
    <% else %>
      <a class="btn btn-outline-primary btn-round" href='active_cases'>Show all</a>
    <% end %>

    <% if @category == 'medical' %>
      <a class="btn btn-primary btn-round" href='active_cases?category=medical'>Medical</a>
    <% else %>
      <a class="btn btn-outline-primary btn-round" href='active_cases?category=medical'>Medical</a>
    <% end %>

    <% if @category == 'agent_fee' %>
      <a class="btn btn-primary btn-round" href='active_cases?category=agent_fee'>Agent Fees</a>
    <% else %>
      <a class="btn btn-outline-primary btn-round" href='active_cases?category=agent_fee'>Agent Fees</a>
    <% end %>

    <% if @category == 'bills' %>
      <a class="btn btn-primary btn-round" href='active_cases?category=bills'>Bills</a>
    <% else %>
      <a class="btn btn-outline-primary btn-round" href='active_cases?category=bills'>Bills</a>
    <% end %>

    <% if @category == 'others' %>
      <a class="btn btn-primary btn-round" href='active_cases?category=others'>Others</a>
    <% else %>
      <a class="btn btn-outline-primary btn-round" href='active_cases?category=others'>Others</a>
    <% end %>
  </div>
</div>
<div class="card-grid mt-5">
  <% @cases.each do |c| %>
    <div class="card" style="width: 22rem;">
      <%# <div class="card-header"> %>
        <%# #<%= c.id %> <%#<%= c.title %>
      <%# </div> %>
      <div class="m-2">
        <div class="card-body card-text">

          <div class="mt-3 title-ellipsis">
            <p class="font-weight-bold text-dark"># <%= c.id %> <%= c.title%></p>
          </div>

          <div class="mt-3">              
            <div class="d-flex">
              <% if c.category == "medical" %>
                <i class="fa fa-plus-square"></i><p><%= c.category.gsub(/_/, ' ').gsub(/\b\w/, &:capitalize) %></p>
              <% end %>
              <% if c.category == "agent_fee" %>
                <i class='fas fa-file-alt'></i><p><%= c.category.gsub(/_/, ' ').gsub(/\b\w/, &:capitalize) %></p>
              <% end %>
              <% if c.category == "others" %>
                <i class='fas fa-hand-holding-heart'></i><p><%= c.category.gsub(/_/, ' ').gsub(/\b\w/, &:capitalize) %></p>
              <% end %>
              <% if c.category == "bills" %>
                <i class='far fa-credit-card'></i><p><%= c.category.gsub(/_/, ' ').gsub(/\b\w/, &:capitalize) %></p>
              <% end %>
            </div>
          </div>

            <%# <tbody>
              <tr>
                <td width="35%" style="vertical-align: text-top;"><strong>Title: </strong></td>
                <td><%= c.title%></td>
              <%# </tr>
              <tr>
                <td><strong>Category: </strong></td>
                <td><%= c.category.gsub(/_/, ' ').gsub(/\b\w/, &:capitalize) %></td>
              <%# </tr>
              <tr>
                <td><strong>Start date: </strong></td>
                <td><%= c.start_date.strftime("%d %B %Y") %></td>
              <%# </tr>
              <tr>
                <td><strong>End date: </strong></td>
                <td><%= c.end_date.strftime("%d %B %Y") %><%#small class="text-muted"> (in <%= time_ago_in_words(c.end_date) %><%#/small></td>
              <%# </tr>
            </tbody>
          </table> %>

          <div class="mt-3 ellipsis">
            <p><%= c.story_summary %></p>
          </div>

          <%= render 'progress', c: c %>

          <p>
            <button class="btn btn-primary mt-2 w-100" type="button" >
              <%= link_to "learn more", "#", target: "_blank" %>
            </button>
          </p>

          <p>
            <button class="btn btn-primary mt-2 w-100" type="button" data-toggle="collapse" data-target="#caseCoordinator<%= c.id %>" aria-expanded="false" aria-controls="caseCoordinator<%= c.id %>">
            Contribute
            </button>
          </p>
          <div class="collapse" id="caseCoordinator<%= c.id %>">
          <!--
            <div class="card-body">
            <p>PayLah</p>
              <div class="paylah-container">
                <p class="text-center"><%= image_tag "paylah.png", alt: "paylah", width: "60%" %></p>
              </div>
              <p> Send your contribution to the QR code above </p>
            </div>
          -->
            <div class="card-body">
            <p>STRIPE</p>
            <p><i class="fab fa-cc-visa fa-2x"></i> <i class="fab fa-cc-mastercard fa-2x"></i> <i class="fab fa-cc-amex fa-2x"></i></p>
              <%= simple_form_for @payment do |f| %>
                <%= hidden_field_tag 'case_id', c.id %>
                <%= f.input :amount %>
                <%= f.button :submit, 'Submit', class: 'btn btn-primary mb-3 btn-wd' %>
              <% end %>
            </div>

          </div>

        </div>
      </div>
    </div>
  <% end %>
</div>
