 <div class="container">
   <%= label_tag "message" %><br />
   <textarea id="telegram-msg" name="telegram-msg" rows="4" cols="80">
     <%= @display_msg %>
   </textarea>
   <button type="button" class="post-button"><i class="fab fa-telegram-plane"></i> Share</button>
  </div>


  <script src="http://js.nicedit.com/nicEdit-latest.js" type="text/javascript"></script>
  <script type="text/javascript">bkLib.onDomLoaded(nicEditors.allTextAreas);</script>

  <script>
    new nicEditor({buttonList : ['bold','italic','underline']}).panelInstance('telegram-msg');
    
    let post_button = document.querySelector(".post-button");
    post_button.addEventListener("click", (e)=>{
      let area = nicEditors.findEditor('telegram-msg'); 
      let content = area.getContent();
      const msg = content.replace(/<div>/g , "").replace(/<\/div>/g , "\n").replace(/<br>/g,"");
      console.log(content);
      console.log(msg)

      fetch("https://api.telegram.org/bot1719790312:AAFWT2mpG1YETwJRmzhHVw6BfxyIAPwC47M/sendMessage", {
          method: "POST",
          headers: {
            "Accept": "application/json",
            "Content-Type": "application/json"
          },
          body: JSON.stringify({ 
            "chat_id":-1001170880075,
            "text": msg,
            "parse_mode": "HTML" 
            })
        })
          .then(response => response.json())
          .then((data) => {
            console.log(data); // Look at local_names.default
          });
    })
  </script>


